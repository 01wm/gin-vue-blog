import{_ as e}from"./CommonPage.1d983d4f.js";import{_ as t}from"./CrudTable.f8f71e39.js";import{m as a,z as s,ac as i,c as r,w as l,o,a as n,b as p,H as d,j as c,bx as m,au as u,av as f,_ as g}from"./index.ddbeb507.js";import{N as h}from"./Image.5a9a9769.js";import{N as y}from"./Popconfirm.e7219379.js";import"./AppPage.662cd676.js";import"./Space.b99b39b1.js";import"./get-slot.8207e825.js";import"./Checkbox.3f865768.js";import"./RadioGroup.4a7ab258.js";import"./Input.ba0cee33.js";import"./Select.7dfcacef.js";import"./Forward.292852ee.js";import"./utils.3e78d745.js";const b=a({name:"在线用户"}),j=Object.assign(b,{setup(a){const b=s(null);i((()=>{var e;null==(e=b.value)||e.handleSearch()}));const j=[{title:"头像",key:"avatar",width:50,align:"center",render:e=>c(h,{height:50,imgProps:{style:{"border-radius":"3px"}},src:m(e.avatar),"fallback-src":"http://dummyimage.com/400x400","show-toolbar-tooltip":!0})},{title:"昵称",key:"nickname",width:60,align:"center",ellipsis:{tooltip:!0}},{title:"登录 IP",key:"ip_address",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>c("span",e.ip_address||"未知")},{title:"登录地址",key:"ip_source",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>c("span",e.ip_source||"未知")},{title:"登录浏览器",key:"browser",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>c("span",e.browser||"未知")},{title:"操作系统",key:"os",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>c("span",e.os||"未知")},{title:"登录时间",key:"last_login_time",align:"center",width:70,render:e=>c(g,{size:"small",type:"text",ghost:!0},{default:()=>u(e.last_login_time),icon:f("mdi:update",{size:18})})},{title:"操作",key:"actions",width:60,align:"center",fixed:"right",render:e=>c(y,{onPositiveClick:()=>function(e){return t=this,a=null,s=function*(){var t;try{yield d.forceOfflineUser(e),$message.success("该用户已被强制下线!"),null==(t=b.value)||t.handleSearch()}catch(a){$message.error("强制下线失败!")}},new Promise(((e,i)=>{var r=e=>{try{o(s.next(e))}catch(t){i(t)}},l=e=>{try{o(s.throw(e))}catch(t){i(t)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,l);o((s=s.apply(t,a)).next())}));var t,a,s}(e)},{trigger:()=>c(g,{size:"small",type:"primary"},{default:()=>"下线",icon:f("material-symbols:delete-outline",{size:14})}),default:()=>c("div",{},"确定强制该用户下线吗?")})}];return(a,s)=>{const i=t,c=e;return o(),r(c,{"show-footer":"",title:"在线用户"},{default:l((()=>[n(i,{ref_key:"$table",ref:b,columns:j,"get-data":p(d).getOnlineUsers},null,8,["get-data"])])),_:1})}}});export{j as default};
