var e=(e,l,a)=>new Promise(((t,r)=>{var i=e=>{try{n(a.next(e))}catch(l){r(l)}},o=e=>{try{n(a.throw(e))}catch(l){r(l)}},n=e=>e.done?t(e.value):Promise.resolve(e.value).then(i,o);n((a=a.apply(e,l)).next())}));import{_ as l}from"./CommonPage.42c5f357.js";import{_ as a}from"./CrudModal.73287289.js";import{o as t,g as r,e as i,H as o,z as n,ac as s,c as u,w as d,a as c,d as m,b as p,bV as v,ak as f,c5 as h,at as b,_ as g,bx as w,t as x,av as y,aU as _}from"./index.8ba31f54.js";import{_ as j}from"./TheIcon.b33e2977.js";import{_ as C}from"./UploadOne.3f96911a.js";import{u as k}from"./useCRUD.abf0b145.js";import{_ as U}from"./Input.cf9d5282.js";import{_ as P,a as F}from"./FormItem.250456a2.js";import{N as O}from"./Image.8f5bdb4c.js";import"./AppPage.4308d760.js";import"./Upload.513c0754.js";import"./Add.d57bd578.js";import"./utils.3e78d745.js";const z={class:"inline-block",viewBox:"0 0 20 20",width:"1em",height:"1em"},I=[i("path",{fill:"currentColor",d:"M19.295 12a.704.704 0 0 1 .705.709v3.204a.704.704 0 0 1-.7.709a.704.704 0 0 1-.7-.709v-1.125C16.779 17.844 13.399 20 9.757 20c-4.41 0-8.106-2.721-9.709-6.915a.712.712 0 0 1 .4-.917c.36-.141.766.04.906.405c1.4 3.662 4.588 6.01 8.403 6.01c3.371 0 6.52-2.182 7.987-5.154l-1.471.01a.704.704 0 0 1-.705-.704a.705.705 0 0 1 .695-.714L19.295 12Zm-9.05-12c4.408 0 8.105 2.721 9.708 6.915a.712.712 0 0 1-.4.917a.697.697 0 0 1-.906-.405c-1.4-3.662-4.588-6.01-8.403-6.01c-3.371 0-6.52 2.182-7.987 5.154l1.471-.01a.704.704 0 0 1 .705.704a.705.705 0 0 1-.695.714L.705 8A.704.704 0 0 1 0 7.291V4.087c0-.392.313-.709.7-.709c.386 0 .7.317.7.709v1.125C3.221 2.156 6.601 0 10.243 0Z"},null,-1)];const S={name:"uiw-reload",render:function(e,l){return t(),r("svg",z,I)}},q={class:"inline-block",viewBox:"0 0 512 512",width:"1em",height:"1em"},A=[i("circle",{cx:"256",cy:"256",r:"48",fill:"currentColor"},null,-1),i("circle",{cx:"416",cy:"256",r:"48",fill:"currentColor"},null,-1),i("circle",{cx:"96",cy:"256",r:"48",fill:"currentColor"},null,-1)];const R={name:"ion-ellipsis-horizontal",render:function(e,l){return t(),r("svg",q,A)}},D={flex:"","flex-wrap":"","justify-between":""},L={absolute:"","top-5":"","right-10":"","text-white":""},T={"text-15":""},V=i("div",{"w-300":"","h-0":""},null,-1),B=i("div",{"w-300":"","h-0":""},null,-1),M=i("div",{"w-300":"","h-0":""},null,-1),Z={flex:"","items-center":"","justify-between":"","w-full":""},E={__name:"index",setup(z){const{modalVisible:I,modalTitle:q,modalLoading:A,handleAdd:E,handleDelete:H,handleEdit:N,handleSave:G,modalForm:J,modalFormRef:K}=k({name:"页面",initForm:{},doCreate:o.saveOrUpdatePage,doDelete:o.deletePage,doUpdate:o.saveOrUpdatePage,refresh:Y});let Q=n([]),W=n(!1);const X=n(null);function Y(){return e(this,null,(function*(){const e=yield o.getPages();Q.value=e.data}))}s((()=>e(this,null,(function*(){Y()}))));const $=[{label:"编辑",key:"edit",icon:y("mingcute:edit-2-line",{size:"15px"})},{label:"删除",key:"delete",icon:y("mingcute:delete-back-line",{size:"15px"})}];return(e,o)=>{const n=j,s=g,y=R,k=_,z=O,Y=U,ee=P,le=S,ae=F,te=a,re=l;return t(),u(re,{"show-footer":"",title:"页面管理"},{action:d((()=>[c(s,{type:"primary",onClick:p(E)},{default:d((()=>[c(n,{icon:"material-symbols:add",size:18}),m(" 新建页面 ")])),_:1},8,["onClick"])])),default:d((()=>[i("div",D,[(t(!0),r(f,null,v(Q.value,(e=>(t(),r("div",{key:e.id,relative:"","w-300":"","my-10":"","text-center":"","cursor-pointer":""},[i("div",L,[c(k,{options:$,onSelect:l=>function(e,l){"edit"===e?N(l):"delete"===e&&H([l.id])}(l,e)},{default:d((()=>[c(y,{"text-white":"","text-20":"","hover:text-blue":""})])),_:2},1032,["onSelect"])]),c(z,{src:p(w)(e.cover),height:"170",width:"300","img-props":{style:{"border-radius":"5px"}}},null,8,["src"]),i("p",T,x(e.name),1)])))),128)),V,B,M]),c(te,{visible:p(I),"onUpdate:visible":o[6]||(o[6]=e=>b(I)?I.value=e:null),width:"550px",title:p(q),loading:p(A),onOnSave:p(G)},{default:d((()=>[c(ae,{ref_key:"modalFormRef",ref:K,"label-placement":"left","label-align":"left","label-width":80,model:p(J)},{default:d((()=>[c(ee,{label:"页面名称",path:"name",rule:{required:!0,message:"请输入页面名称",trigger:["input","blur"]}},{default:d((()=>[c(Y,{value:p(J).name,"onUpdate:value":o[0]||(o[0]=e=>p(J).name=e),placeholder:"页面名称"},null,8,["value"])])),_:1}),c(ee,{label:"页面标签",path:"label",rule:{required:!0,message:"请输入页面标签",trigger:["input","blur"]}},{default:d((()=>[c(Y,{value:p(J).label,"onUpdate:value":o[1]||(o[1]=e=>p(J).label=e),placeholder:"页面标签"},null,8,["value"])])),_:1}),c(ee,{label:"页面封面",path:"cover",rule:{required:!0,message:"请上传封面图片",trigger:["input","blur"]}},{default:d((()=>[i("div",Z,[c(C,{ref_key:"uploadOneRef",ref:X,preview:p(J).cover,"onUpdate:preview":o[2]||(o[2]=e=>p(J).cover=e),width:300,onFinish:o[3]||(o[3]=e=>p(J).cover=e)},null,8,["preview"]),c(le,{class:h(W.value?"animate-spin":""),"text-20":"","cursor-pointer":"",onClick:o[4]||(o[4]=e=>{return l=p(J).cover,W.value=!0,X.value.previewImg=l,void setTimeout((()=>W.value=!1),1e3);var l})},null,8,["class"])])])),_:1}),c(ee,{label:"封面链接",path:"cover",rule:{required:!0,message:"请输入封面链接",trigger:["input","blur"]}},{default:d((()=>[c(Y,{value:p(J).cover,"onUpdate:value":o[5]||(o[5]=e=>p(J).cover=e),type:"textarea",placeholder:"图片上传成功自动生成，或者直接复制外链"},null,8,["value"])])),_:1})])),_:1},8,["model"])])),_:1},8,["visible","title","loading","onOnSave"])])),_:1})}}};export{E as default};
