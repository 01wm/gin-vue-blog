import{_ as e}from"./CommonPage.90710f2e.js";import{_ as t}from"./CrudTable.92e515e8.js";import{m as s,z as a,ac as i,c as r,w as l,o,a as n,b as c,H as p,j as d,bx as m,au as u,av as f,_ as g}from"./index.fc8a4220.js";import{N as h}from"./Image.7ac1ed0b.js";import{N as y}from"./Popconfirm.a5efd3d5.js";import"./AppPage.19cd2eee.js";import"./Space.9795b332.js";import"./get-slot.8207e825.js";import"./Checkbox.4ef1ea81.js";import"./RadioGroup.5e2ed13e.js";import"./Input.03701cc7.js";import"./Select.c8646cc6.js";import"./Forward.80f15f48.js";import"./utils.3e78d745.js";const j=s({name:"在线用户"}),w=Object.assign(j,{setup(s){const j=a(null);i((()=>{var e;null==(e=j.value)||e.handleSearch()}));const w=[{title:"头像",key:"avatar",width:50,align:"center",render:e=>d(h,{height:50,imgProps:{style:{"border-radius":"3px"}},src:m(e.avatar),"fallback-src":"http://dummyimage.com/400x400","show-toolbar-tooltip":!0})},{title:"昵称",key:"nickname",width:60,align:"center",ellipsis:{tooltip:!0}},{title:"登录 IP",key:"ip_address",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>d("span",e.ip_address||"未知")},{title:"登录地址",key:"ip_source",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>d("span",e.ip_source||"未知")},{title:"登录浏览器",key:"browser",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>d("span",e.browser||"未知")},{title:"操作系统",key:"os",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>d("span",e.os||"未知")},{title:"登录时间",key:"last_login_time",align:"center",width:70,render:e=>d(g,{size:"small",type:"text",ghost:!0},{default:()=>u(e.last_login_time),icon:f("mdi:update",{size:18})})},{title:"操作",key:"actions",width:60,align:"center",fixed:"right",render:e=>d(y,{onPositiveClick:()=>function(e){return t=this,s=null,a=function*(){var t;try{yield p.forceOfflineUser(e),$message.success("该用户已被强制下线!"),null==(t=j.value)||t.handleSearch()}catch(s){$message.error("强制下线失败!")}},new Promise(((e,i)=>{var r=e=>{try{o(a.next(e))}catch(t){i(t)}},l=e=>{try{o(a.throw(e))}catch(t){i(t)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,l);o((a=a.apply(t,s)).next())}));var t,s,a}(e)},{trigger:()=>d(g,{size:"small",type:"primary"},{default:()=>"下线",icon:f("material-symbols:delete-outline",{size:14})}),default:()=>d("div",{},"确定强制该用户下线吗?")})}];return(s,a)=>{const i=t,d=e;return o(),r(d,{"show-footer":"",title:"在线用户"},{default:l((()=>[n(i,{ref_key:"$table",ref:j,columns:w,"get-data":c(p).getOnlineUsers},null,8,["get-data"])])),_:1})}}});export{w as default};
