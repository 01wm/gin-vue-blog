import{_ as e}from"./CommonPage.42c5f357.js";import{_ as t}from"./CrudTable.8a53b5ee.js";import{m as s,z as a,ac as i,c as r,w as l,o,a as n,b as c,H as d,j as p,bx as m,au as u,av as f,_ as g}from"./index.8ba31f54.js";import{N as h}from"./Image.8f5bdb4c.js";import{N as b}from"./Popconfirm.caadfb99.js";import"./AppPage.4308d760.js";import"./Space.67b6b1d7.js";import"./get-slot.8207e825.js";import"./Checkbox.b843ab15.js";import"./RadioGroup.100f224c.js";import"./Input.cf9d5282.js";import"./Select.ef01f3df.js";import"./Forward.0d5f42cb.js";import"./utils.3e78d745.js";const y=s({name:"在线用户"}),j=Object.assign(y,{setup(s){const y=a(null);i((()=>{var e;null==(e=y.value)||e.handleSearch()}));const j=[{title:"头像",key:"avatar",width:50,align:"center",render:e=>p(h,{height:50,imgProps:{style:{"border-radius":"3px"}},src:m(e.avatar),"fallback-src":"http://dummyimage.com/400x400","show-toolbar-tooltip":!0})},{title:"昵称",key:"nickname",width:60,align:"center",ellipsis:{tooltip:!0}},{title:"登录 IP",key:"ip_address",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>p("span",e.ip_address||"未知")},{title:"登录地址",key:"ip_source",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>p("span",e.ip_source||"未知")},{title:"登录浏览器",key:"browser",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>p("span",e.browser||"未知")},{title:"操作系统",key:"os",width:70,align:"center",ellipsis:{tooltip:!0},render:e=>p("span",e.os||"未知")},{title:"登录时间",key:"last_login_time",align:"center",width:70,render:e=>p(g,{size:"small",type:"text",ghost:!0},{default:()=>u(e.last_login_time),icon:f("mdi:update",{size:18})})},{title:"操作",key:"actions",width:60,align:"center",fixed:"right",render:e=>p(b,{onPositiveClick:()=>function(e){return t=this,s=null,a=function*(){var t;try{yield d.forceOfflineUser(e),$message.success("该用户已被强制下线!"),null==(t=y.value)||t.handleSearch()}catch(s){$message.error("强制下线失败!")}},new Promise(((e,i)=>{var r=e=>{try{o(a.next(e))}catch(t){i(t)}},l=e=>{try{o(a.throw(e))}catch(t){i(t)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,l);o((a=a.apply(t,s)).next())}));var t,s,a}(e)},{trigger:()=>p(g,{size:"small",type:"primary"},{default:()=>"下线",icon:f("material-symbols:delete-outline",{size:14})}),default:()=>p("div",{},"确定强制该用户下线吗?")})}];return(s,a)=>{const i=t,p=e;return o(),r(p,{"show-footer":"",title:"在线用户"},{default:l((()=>[n(i,{ref_key:"$table",ref:y,columns:j,"get-data":c(d).getOnlineUsers},null,8,["get-data"])])),_:1})}}});export{j as default};
