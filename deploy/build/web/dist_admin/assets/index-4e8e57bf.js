import{_ as D}from"./CrudModal-d60ad9bd.js";import{_ as R}from"./UploadOne-9ac81f84.js";import{_ as q}from"./CommonPage-7491aea4.js";import{k as p,x as O,m as n,o as c,c as P,w as s,a,b as V,u as e,d as r,a1 as g,ae as $,ad as E,b3 as L,y as T,N as j,b4 as z,E as A,t as M,B as h}from"./index-7e9df7d9.js";import{u as G}from"./useCRUD-f64dec52.js";import{N as H}from"./Image-77507ba9.js";import{N as J,a as d}from"./FormItem-e99f0659.js";import{N as f}from"./Input-5db271d7.js";import"./Upload-667cd4e3.js";import"./Add-3a899e67.js";import"./AppPage-848b5b84.js";import"./utils-3c01791b.js";const K=r("span",{class:"i-material-symbols:add"},null,-1),Q={class:"flex flex-wrap justify-between"},W={class:"absolute right-10 top-5 text-white"},X=r("span",{class:"i-ion:ellipsis-horizontal h-20 w-20 text-white hover:text-blue"},null,-1),Y={class:"text-15"},Z=r("div",{class:"h-0 w-300"},null,-1),ee=r("div",{class:"h-0 w-300"},null,-1),te=r("div",{class:"h-0 w-300"},null,-1),le={class:"w-full flex items-center justify-between"},_e={__name:"index",setup(ae){const{modalVisible:u,modalTitle:w,modalLoading:x,handleAdd:y,handleDelete:N,handleEdit:k,handleSave:U,modalForm:o,modalFormRef:F}=G({name:"页面",initForm:{},doCreate:n.saveOrUpdatePage,doDelete:n.deletePage,doUpdate:n.saveOrUpdatePage,refresh:b}),v=p([]),m=p(!1),_=p(null);O(async()=>{b()});async function b(){const i=await n.getPages();v.value=i.data}function C(i){m.value=!0,_.value.previewImg=i,setTimeout(()=>m.value=!1,1e3)}function I(i,t){i==="edit"?k(t):i==="delete"&&N([t.id])}const S=[{label:"编辑",key:"edit",icon:h("mingcute:edit-2-line",{})},{label:"删除",key:"delete",icon:h("mingcute:delete-back-line",{})}];return(i,t)=>(c(),P(q,{title:"页面管理"},{action:s(()=>[a(e(j),{type:"primary",onClick:e(y)},{icon:s(()=>[K]),default:s(()=>[V(" 新建页面 ")]),_:1},8,["onClick"])]),default:s(()=>[r("div",Q,[(c(!0),g(E,null,$(v.value,l=>(c(),g("div",{key:l.id,class:"relative my-10 w-300 cursor-pointer text-center"},[r("div",W,[a(e(z),{options:S,onSelect:B=>I(B,l)},{default:s(()=>[X]),_:2},1032,["onSelect"])]),a(e(H),{src:e(A)(l.cover),height:"170",width:"300","img-props":{style:{"border-radius":"5px"}}},null,8,["src"]),r("p",Y,M(l.name),1)]))),128)),Z,ee,te]),a(D,{visible:e(u),"onUpdate:visible":t[6]||(t[6]=l=>T(u)?u.value=l:null),width:"550px",title:e(w),loading:e(x),onSave:e(U)},{default:s(()=>[a(e(J),{ref_key:"modalFormRef",ref:F,"label-placement":"left","label-align":"left","label-width":80,model:e(o)},{default:s(()=>[a(e(d),{label:"页面名称",path:"name",rule:{required:!0,message:"请输入页面名称",trigger:["input","blur"]}},{default:s(()=>[a(e(f),{value:e(o).name,"onUpdate:value":t[0]||(t[0]=l=>e(o).name=l),placeholder:"页面名称"},null,8,["value"])]),_:1}),a(e(d),{label:"页面标签",path:"label",rule:{required:!0,message:"请输入页面标签",trigger:["input","blur"]}},{default:s(()=>[a(e(f),{value:e(o).label,"onUpdate:value":t[1]||(t[1]=l=>e(o).label=l),placeholder:"页面标签"},null,8,["value"])]),_:1}),a(e(d),{label:"页面封面",path:"cover",rule:{required:!0,message:"请上传封面图片",trigger:["input","blur"]}},{default:s(()=>[r("div",le,[a(R,{ref_key:"uploadOneRef",ref:_,preview:e(o).cover,"onUpdate:preview":t[2]||(t[2]=l=>e(o).cover=l),width:300,onFinish:t[3]||(t[3]=l=>e(o).cover=l)},null,8,["preview"]),r("span",{class:L(["i-uiw:reload h-20 w-20 cursor-pointer",m.value?"animate-spin":""]),onClick:t[4]||(t[4]=l=>C(e(o).cover))},null,2)])]),_:1}),a(e(d),{label:"封面链接",path:"cover",rule:{required:!0,message:"请输入封面链接",trigger:["input","blur"]}},{default:s(()=>[a(e(f),{value:e(o).cover,"onUpdate:value":t[5]||(t[5]=l=>e(o).cover=l),type:"textarea",placeholder:"图片上传成功自动生成，或者直接复制外链"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title","loading","onSave"])]),_:1}))}};export{_e as default};
