import{u as D,a as I,b as L,c as R,r as q,d as B,e as T,o as C,f as J,w as h,n as O,g as t,h as y,t as U,i,j as m,k as V,_ as j,N as K,l as $,m as A}from"./index-7d3bcf57.js";import{_ as z}from"./AppPage-e3cb8e40.js";import{N as v}from"./Input-41b621cb.js";import{N as F}from"./Checkbox-b4c2fca7.js";const x="__SecretKey__";function G(e,s,o=60*60*24*7){const a=JSON.stringify({value:s,time:Date.now(),expire:o?new Date().getTime()+o*1e3:null});window.localStorage.setItem(e,Y(a))}function P(e){const s=window.localStorage.getItem(e);if(s){const o=E(s),{value:a,expire:d}=JSON.parse(o);if(!d||d>new Date().getTime())return a}return b(e),null}function b(e){window.localStorage.removeItem(e)}function Y(e){const s=JSON.stringify(e);return btoa(x+s)}function E(e){const o=atob(e).replace(x,"");try{return JSON.parse(o)}catch{return null}}const H="/admin/image/login_banner.webp",M={style:{transform:"translateY(25px)"},class:"m-auto max-w-700 min-w-345 flex items-center justify-center rounded-10 bg-white bg-opacity-60 p-15 shadow"},Q=t("div",{class:"hidden w-380 px-20 py-35 md:block"},[t("img",{src:H,class:"w-full",alt:"login_banner"})],-1),W={class:"w-320 flex flex-col px-20 py-35"},X={class:"flex items-center justify-center text-24 text-gray font-normal"},Z=t("img",{src:j,alt:"logo",class:"mr-10 h-50 w-50"},null,-1),ee={class:"mt-30"},te={class:"mt-30"},se={class:"mt-20"},oe={class:"mt-20"},le={__name:"Login",setup(e){const s="Gin Blog Admin",o=D(),a=I(),d=L(),{query:u}=R(),n=q({username:"test@qq.com",password:"11111"});S();function S(){const r=P("loginInfo");r&&(n.username=r.username,n.password=r.password)}const p=B("isRemember",!1),g=T(!1);async function f(){const{username:r,password:c}=n;if(!r||!c){$message.warning("请输入用户名和密码");return}(async(_,w)=>{g.value=!0;try{const N=await $.login({username:_,password:w});if(a.setToken(N.data.token),$message.success("登录成功"),await o.getUserInfo(),p?G("loginInfo",{username:_,password:w}):b("loginInfo"),await A(),u.redirect){const k=u.redirect;Reflect.deleteProperty(u,"redirect"),d.push({path:k,query:u})}else d.push("/")}finally{g.value=!1}})(r,c)}return(r,c)=>(C(),J(z,{class:"bg-cover",style:O({backgroundImage:"url(/image/login_bg.webp)"})},{default:h(()=>[t("div",M,[Q,t("div",W,[t("h5",X,[Z,y(" "+U(i(s)),1)]),t("div",ee,[m(i(v),{value:n.username,"onUpdate:value":c[0]||(c[0]=l=>n.username=l),class:"autofocus h-50 items-center pl-10 text-16",placeholder:"test@qq.com",maxlength:20},null,8,["value"])]),t("div",te,[m(i(v),{value:n.password,"onUpdate:value":c[1]||(c[1]=l=>n.password=l),class:"h-50 items-center pl-10 text-16",type:"password","show-password-on":"mousedown",placeholder:"11111",maxlength:20,onKeydown:V(f,["enter"])},null,8,["value"])]),t("div",se,[m(i(F),{checked:i(p),label:"记住我","on-update:checked":l=>p.value=l},null,8,["checked","on-update:checked"])]),t("div",oe,[m(i(K),{class:"h-50 w-full rounded-5 text-16",type:"primary",loading:g.value,onClick:f},{default:h(()=>[y(" 登录 ")]),_:1},8,["loading"])])])])]),_:1},8,["style"]))}};export{le as default};
